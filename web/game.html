<!DOCTYPE HTML>
<html>
	<head>
		<title>The Wedding Games</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
        <link rel="stylesheet" href="assets/css/bootstrap-grid.min.css" />
        <link rel="stylesheet" href="assets/css/bootstrap-reboot.min.css" />
        <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
        <link rel="stylesheet" href="assets/css/animate.css" />
        <link rel="stylesheet" href="assets/css/main.css">
        <link rel="stylesheet" href="assets/css/party.css" />
	</head>
    <body style="background-color: black">
        <div id="umbrella" style="position: relative">
            <form id="registrationForm" name="login-form" class="login-form animated" style="position: absolute; z-index: 50;" action="" method="post">
                <img src="assets/game/wedding-games-header.png" style="display: block; margin-left: auto; margin-right: auto" />
                <div class="header">
                    <h1>You got a high score!</h1>
                    <span>Enter your name to complete registration</span>
                </div>
            
                <div class="content">
                    <input id="playerName" name="name" type="text" class="input username" placeholder="Name" autofocus="true" />
                </div>
        
                <div class="footer">
                    <a href="#" class="button" onclick="addPlayer()">Save</a>
                </div>
            
            </form>

            <canvas id="canvas" style="width: 100%; height: 100%; border: 1px solid blue" width="2048" height="1152"></canvas>
        </div>

        <!-- Scripts -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/createjs.min.js"></script>
        <script src="assets/js/clients/PlayerClient.js"></script>
        <script src="assets/game/game.js"></script>
        <script>
            const registrationForm = $("#registrationForm")
            registrationForm.hide()

            const playerClient = PlayerClient()
            
            const game = new Game("canvas")

            game.init(function() {
                game.startGame()
            })

            function gameOver() {
                parent = registrationForm.parent()
                registrationForm.css("left", `${parent.width() / 2 - registrationForm.width() / 2}px`)
                registrationForm.css("top", `${parent.height() / 2 - registrationForm.height() / 2}px`)
                registrationForm.on("animationend", function() { 
                    registrationForm.off("animationend")
                    const textbox = $(".login-form input[name]")
                    textbox.focus()
                 })
                 registrationForm.show()
                 registrationForm.addClass("animated flipInY")
            }

            game.onGameWon(gameOver)
            game.onGameLost(gameOver)

            function addPlayer() {
                const player = {
                    name: $("playerName").text()
                }
                playerClient.addPlayer(player)
                // TODO Send success message to player and clear screen
            }

            window.onkeydown = game.keyboardInput
        </script>
	</body>
</html>